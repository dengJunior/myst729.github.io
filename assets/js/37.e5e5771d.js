(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{68:function(t,a,s){"use strict";s.r(a);var n=s(0),o=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"自定义元素：在-html-中定义新元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义元素：在-html-中定义新元素","aria-hidden":"true"}},[t._v("#")]),t._v(" 自定义元素：在 HTML 中定义新元素")]),s("blockquote",[s("p",[t._v("本文翻译自 "),s("a",{attrs:{href:"http://www.html5rocks.com/en/tutorials/webcomponents/customelements/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Custom Elements: defining new elements in HTML")]),t._v("（需翻墙），已于 2014 年 1 月 8 日修订后提交至 "),s("a",{attrs:{href:"http://www.html5rocks.com/zh/tutorials/webcomponents/customelements/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML5Rocks")]),t._v("。")]),s("p",[t._v("补充；由于相关规范尚在演化中，译文介绍的内容可能失效。如果遇到这种情况请查阅原文最新的修订版本。")])]),s("h2",{attrs:{id:"本文目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本文目录","aria-hidden":"true"}},[t._v("#")]),t._v(" 本文目录")]),s("ul",[s("li",[t._v("引言\n"),s("ul",[s("li",[t._v("时髦的标记，行动起来！")])])]),s("li",[t._v("赶紧开始吧\n"),s("ul",[s("li",[t._v("注册新元素")]),s("li",[t._v("扩展原生元素")]),s("li",[t._v("元素如何提升\n"),s("ul",[s("li",[t._v("Unresolved 元素")])])])])]),s("li",[t._v("实例化元素\n"),s("ul",[s("li",[t._v("实例化自定义标签")]),s("li",[t._v("实例化类型扩展元素")])])]),s("li",[t._v("添加 JS 属性和方法\n"),s("ul",[s("li",[t._v("生命周期回调方法")])])]),s("li",[t._v("添加标记\n"),s("ul",[s("li",[t._v("用 Shadow DOM 封装内部实现")]),s("li",[t._v("从模板创建元素")])])]),s("li",[t._v("为自定义元素增加样式\n"),s("ul",[s("li",[t._v("为使用 Shadow DOM 的元素增加样式")]),s("li",[t._v("使用 "),s("code",[t._v(":unresolved")]),t._v(" 伪类避免无样式内容闪烁（FOUC）")])])]),s("li",[t._v("历史和浏览器支持\n"),s("ul",[s("li",[t._v("特性检测")]),s("li",[t._v("浏览器支持")]),s("li",[s("code",[t._v("HTMLElementElement")]),t._v(" 怎么了？")])])]),s("li",[t._v("结语")])]),s("p",[s("strong",[t._v("注意！这篇文章介绍的 API 尚未完全标准化，并且仍在变动中，在项目中使用这些实验性 API 时请务必谨慎。")])]),s("h2",{attrs:{id:"引言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引言","aria-hidden":"true"}},[t._v("#")]),t._v(" 引言")]),s("p",[t._v("现在的 web 严重缺乏表达能力。你只要瞧一眼“现代”的 web 应用，比如 GMail，就会明白我的意思：")]),s("blockquote",[s("img",{staticClass:"lone-block",attrs:{src:"/blog/images/2013/09/gmail.png"}}),s("p",[t._v("（图：现代 web 应用：使用 "),s("code",[t._v("<div>")]),t._v(" 堆砌而成。）")])]),s("p",[t._v("堆砌 "),s("code",[t._v("<div>")]),t._v(" 一点都不现代。然而可悲的是，这就是我们构建 web 应用的方式。在现有基础上我们不应该有更高的追求吗？")]),s("h3",{attrs:{id:"时髦的标记，行动起来！"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#时髦的标记，行动起来！","aria-hidden":"true"}},[t._v("#")]),t._v(" 时髦的标记，行动起来！")]),s("p",[t._v("HTML 为我们提供了一个完美的文档组织工具，然而 "),s("a",{attrs:{href:"http://www.whatwg.org/specs/web-apps/current-work/multipage/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML 规范")]),t._v("定义的元素却很有限。")]),s("p",[t._v("假如 GMail 的标记不那么糟糕，而是像下面这样漂亮，那会怎样？")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("hangout-module")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("hangout-chat")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("from")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Paul, Addy"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("hangout-discussion")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("hangout-message")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("from")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Paul"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("profile")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("profile.png"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("profile")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("118075919496626375791"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("datetime")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2013-07-17T12:02"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Feelin’ this Web Components thing."),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Heard of it?"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("hangout-message")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("hangout-discussion")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("hangout-chat")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("hangout-chat")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("..."),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("hangout-chat")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("hangout-module")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[s("a",{attrs:{href:"https://myst729.github.io/blog/examples/hangouts-on-polymer",target:"_blank",rel:"noopener noreferrer"}},[t._v("查看演示！")])]),s("p",[t._v("真是令人耳目一新！这个应用太合理了，既"),s("strong",[t._v("有意义")]),t._v("，又"),s("strong",[t._v("容易理解")]),t._v("。最妙的是，它是"),s("strong",[t._v("可维护")]),t._v("的，只要查看声明结构就可以清楚地知道它的作用。")]),s("blockquote",[s("p",[t._v("自定义元素，救救我们！就指望你了！")])]),s("h2",{attrs:{id:"赶紧开始吧"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#赶紧开始吧","aria-hidden":"true"}},[t._v("#")]),t._v(" 赶紧开始吧")]),s("p",[s("a",{attrs:{href:"http://w3c.github.io/webcomponents/spec/custom/",target:"_blank",rel:"noopener noreferrer"}},[t._v("自定义元素")]),s("strong",[t._v("允许开发者定义新的 HTML 元素类型")]),t._v("。该规范只是 "),s("a",{attrs:{href:"http://w3c.github.io/webcomponents/explainer/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web 组件")]),t._v("模块提供的众多新 API 中的一个，但它也很可能是最重要的一个。没有自定义元素带来的以下特性，Web 组件都不会存在：")]),s("ol",[s("li",[t._v("定义新的 HTML/DOM 元素")]),s("li",[t._v("基于其他元素创建扩展元素")]),s("li",[t._v("给一个标签绑定一组自定义功能")]),s("li",[t._v("扩展已有 DOM 元素的 API")])]),s("h3",{attrs:{id:"注册新元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册新元素","aria-hidden":"true"}},[t._v("#")]),t._v(" 注册新元素")]),s("p",[t._v("使用 "),s("code",[t._v("document.registerElement()")]),t._v(" 可以创建一个自定义元素：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("XFoo")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[s("code",[t._v("document.registerElement()")]),t._v(" 的第一个参数是元素的标签名。这个标签名"),s("strong",[t._v("必须包括一个连字符（-）")]),t._v("。因此，诸如 "),s("code",[t._v("<x-tags>")]),t._v("、"),s("code",[t._v("<my-element>")]),t._v(" 和 "),s("code",[t._v("<my-awesome-app>")]),t._v(" 都是合法的标签名，而 "),s("code",[t._v("<tabs>")]),t._v(" 和 "),s("code",[t._v("<foo_bar>")]),t._v(" 则不是。这个限定使解析器能很容易地区分自定义元素和 HTML 规范定义的元素，同时确保了 HTML 增加新标签时的向前兼容。")]),s("p",[t._v("第二个参数是一个（可选的）对象，用于描述该元素的 "),s("code",[t._v("prototype")]),t._v("。在这里可以为元素添加自定义功能（例如：公开属性和方法）。稍后详述。")]),s("p",[t._v("自定义元素默认继承自 "),s("code",[t._v("HTMLElement")]),t._v("，因此上一个示例等同于：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("create")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTMLElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[t._v("调用 "),s("code",[t._v("document.registerElement('x-foo')")]),t._v(" 向浏览器注册了这个新元素，并返回一个可以用来创建 "),s("code",[t._v("<x-foo>")]),t._v(" 元素实例的构造器。如果你不想使用构造器，也可以使用其他实例化元素的技术。")]),s("p",[t._v("**提示：**如果你不希望在 "),s("code",[t._v("window")]),t._v(" 全局对象中创建元素构造器，还可以把它放进命名空间：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" myapp "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmyapp"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("XFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("h3",{attrs:{id:"扩展原生元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#扩展原生元素","aria-hidden":"true"}},[t._v("#")]),t._v(" 扩展原生元素")]),s("p",[t._v("假设平淡无奇的原生 "),s("code",[t._v("<button>")]),t._v(" 元素不能满足你的需求，你想将其增强为一个“超级按钮”，可以通过创建一个继承 "),s("code",[t._v("HTMLButtonElement.prototype")]),t._v(" 的新元素，来扩展 "),s("code",[t._v("<button>")]),t._v(" 元素：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" MegaButton "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'mega-button'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("create")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTMLButtonElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("extends")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'button'")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[s("strong",[t._v("提示："),s("strong",[t._v("要创建扩展自")]),t._v("元素 B")]),t._v(" 的"),s("strong",[t._v("元素 A")]),t._v("，"),s("strong",[t._v("元素 A")]),t._v(" 必须继承"),s("strong",[t._v("元素 B")]),t._v(" 的 "),s("code",[t._v("prototype")]),t._v("。")]),s("p",[t._v("这类自定义元素被称为"),s("em",[t._v("类型扩展自定义元素")]),t._v("。它们以继承某个特定 "),s("code",[t._v("HTMLElement")]),t._v(" 的方式表达了“元素 X 是一个 Y”。")]),s("p",[t._v("示例：")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("is")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("mega-button"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("h3",{attrs:{id:"元素如何提升"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#元素如何提升","aria-hidden":"true"}},[t._v("#")]),t._v(" 元素如何提升")]),s("p",[t._v("你有没有想过为什么 HTML 解析器对非标准标签不报错？比如，我们在页面中声明一个 "),s("code",[t._v("<randomtag>")]),t._v("，一切都很和谐。根据 "),s("a",{attrs:{href:"http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#htmlunknownelement",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML 规范")]),t._v("的表述：")]),s("blockquote",[s("p",[t._v("非规范定义的元素必须使用 "),s("code",[t._v("HTMLUnknownElement")]),t._v(" 接口。\n"),s("cite",[t._v(" - HTML 规范")])])]),s("p",[s("code",[t._v("<randomtag>")]),t._v(" 是非标准的，它会继承 "),s("code",[t._v("HTMLUnknownElement")]),t._v("。")]),s("p",[t._v("对自定义元素来说，情况就不一样了。**拥有合法元素名的自定义元素将继承 "),s("code",[t._v("HTMLElement")]),t._v("。**你可以按 "),s("kbd",[t._v("Ctrl")]),t._v(" + "),s("kbd",[t._v("Shift")]),t._v(" + "),s("kbd",[t._v("J")]),t._v("（Mac 系统为 "),s("kbd",[t._v("⌘")]),t._v(" + "),s("kbd",[t._v("Option")]),t._v(" + "),s("kbd",[t._v("J")]),t._v("）打开控制台，运行下面这段代码，得到的结果将是 "),s("code",[t._v("true")]),t._v("：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// “tabs”不是一个合法的自定义元素名")]),t._v("\ndocument"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'tabs'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__proto__ "),s("span",{attrs:{class:"token operator"}},[t._v("===")]),t._v(" HTMLUnknownElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// “x-tabs”是一个合法的自定义元素名")]),t._v("\ndocument"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-tabs'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__proto__ "),s("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" HTMLElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype\n")])]),s("p",[t._v("**注意：**在不支持 "),s("code",[t._v("document.registerElement()")]),t._v(" 的浏览器中，"),s("code",[t._v("<x-tabs>")]),t._v(" 仍为 "),s("code",[t._v("HTMLUnknownElement")]),t._v("。")]),s("h4",{attrs:{id:"unresolved-元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unresolved-元素","aria-hidden":"true"}},[t._v("#")]),t._v(" Unresolved 元素")]),s("p",[t._v("由于自定义元素是通过脚本执行 "),s("code",[t._v("document.registerElement()")]),t._v(" 注册的，因此 "),s("strong",[t._v("它们可能在元素定义被注册到浏览器"),s("em",[t._v("之前")]),t._v("就已经声明或创建过了")]),t._v("。例如：你可以先在页面中声明 "),s("code",[t._v("<x-tabs>")]),t._v("，以后再调用 "),s("code",[t._v("document.registerElement('x-tabs')")]),t._v("。")]),s("p",[t._v("在被提升到其定义之前，这些元素被称为 "),s("strong",[t._v("unresolved 元素")]),t._v("。它们是拥有合法自定义元素名的 HTML 元素，只是还没有注册成为自定义元素。")]),s("p",[t._v("下面这个表格看起来更直观一些：")]),s("table",[s("thead",[s("tr",[s("th",[t._v("类型")]),s("th",[t._v("继承自")]),s("th",[t._v("示例")])])]),s("tbody",[s("tr",[s("td",[t._v("unresolved")]),s("td",[s("code",[t._v("HTMLElement")])]),s("td",[s("code",[t._v("<x-tabs>")]),t._v("、"),s("code",[t._v("<my-element>")]),t._v("、"),s("code",[t._v("<my-awesome-app>")])])]),s("tr",[s("td",[t._v("未知元素")]),s("td",[s("code",[t._v("HTMLUnknownElement")])]),s("td",[s("code",[t._v("<tabs>")]),t._v("、"),s("code",[t._v("<foo_bar>")])])])])]),s("blockquote",[s("p",[t._v("把 unresolved 元素想象成尚处于中间状态，它们都是等待被浏览器提升的潜在候选者。浏览器说：“你具备一个新元素的全部特征，我保证会在赋予你定义的时候将你提升为一个元素”。")])]),s("h2",{attrs:{id:"实例化元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实例化元素","aria-hidden":"true"}},[t._v("#")]),t._v(" 实例化元素")]),s("p",[t._v("我们创建普通元素用到的一些技术也可以用于自定义元素。和所有标准定义的元素一样，自定义元素既可以在 HTML 中声明，也可以通过 JavaScript 在 DOM 中创建。")]),s("h3",{attrs:{id:"实例化自定义标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实例化自定义标签","aria-hidden":"true"}},[t._v("#")]),t._v(" 实例化自定义标签")]),s("p",[s("strong",[t._v("声明")]),t._v("元素：")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("x-foo")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("x-foo")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("在 JS 中"),s("strong",[t._v("创建 DOM")]),t._v("：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nxFoo"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'click'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token function"}},[t._v("alert")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'Thanks!'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[t._v("使用 "),s("strong",[s("code",[t._v("new")]),t._v(" 操作符")]),t._v("：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("XFoo")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xFoo"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("h3",{attrs:{id:"实例化类型扩展元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实例化类型扩展元素","aria-hidden":"true"}},[t._v("#")]),t._v(" 实例化类型扩展元素")]),s("p",[t._v("实例化类型扩展自定义元素的方法和自定义标签惊人地相似。")]),s("p",[s("strong",[t._v("声明")]),t._v("元素：")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("\x3c!-- <button> “是一个”超级按钮 --\x3e")]),t._v("\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("is")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("mega-button"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("在 JS 中"),s("strong",[t._v("创建 DOM")]),t._v("：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" megaButton "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'button'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'mega-button'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("// megaButton instanceof MegaButton === true")]),t._v("\n")])]),s("p",[t._v("看，这是接收第二个参数为 "),s("code",[t._v('is=""')]),t._v(" 属性的 "),s("code",[t._v("document.createElement()")]),t._v(" 重载版本。")]),s("p",[t._v("使用 "),s("strong",[s("code",[t._v("new")]),t._v(" 操作符")]),t._v("：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" megaButton "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("MegaButton")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("megaButton"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[t._v("现在，我们已经学习了如何使用 "),s("code",[t._v("document.registerElement()")]),t._v(" 来向浏览器注册一个新标签。但这还不够，接下来我们要向新标签添加属性和方法。")]),s("h2",{attrs:{id:"添加-js-属性和方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加-js-属性和方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 添加 JS 属性和方法")]),s("p",[t._v("自定义元素最强大的地方在于，你可以在元素定义中加入属性和方法，给元素绑定特定的功能。你可以把它想象成一种给你的元素创建公开 API 的方法。")]),s("p",[t._v("这里有一个完整的示例：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFooProto "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("create")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTMLElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 1. 为 x-foo 创建 foo() 方法")]),t._v("\nXFooProto"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("foo")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token function"}},[t._v("alert")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'foo() called'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 2. 定义一个只读的“bar”属性")]),t._v("\nObject"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("defineProperty")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("XFooProto"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"bar"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("value"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("5")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 3. 注册 x-foo 的定义")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" XFooProto"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 4. 创建一个 x-foo 实例")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xfoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 5. 插入页面")]),t._v("\ndocument"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xfoo"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[t._v("构造 "),s("code",[t._v("prototype")]),t._v(" 的方法多种多样，如果你不喜欢上面这种方式，再看一个更简洁的例子：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("create")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTMLElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    bar"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{attrs:{class:"token keyword"}},[t._v("get")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token number"}},[t._v("5")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    foo"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      value"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token function"}},[t._v("alert")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'foo() called'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[t._v("以上两种方式，第一种使用了 ES5 的 "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("Object.defineProperty")])]),t._v("，第二种则使用了 "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/get",target:"_blank",rel:"noopener noreferrer"}},[t._v("get/set")]),t._v("。")]),s("h3",{attrs:{id:"生命周期回调方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生命周期回调方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 生命周期回调方法")]),s("p",[t._v("元素可以定义特殊的方法，来注入其生存期内关键的时间点。这些方法各自有特定的名称和用途，它们被恰如其分地命名为"),s("strong",[t._v("生命周期回调")]),t._v("：")]),s("table",[s("thead",[s("tr",[s("th",[t._v("回调名称")]),s("th",[t._v("调用时间点")])])]),s("tbody",[s("tr",[s("td",[s("code",[t._v("createdCallback")])]),s("td",[t._v("创建元素实例")])]),s("tr",[s("td",[s("code",[t._v("attachedCallback")])]),s("td",[t._v("向文档插入实例")])]),s("tr",[s("td",[s("code",[t._v("detachedCallback")])]),s("td",[t._v("从文档中移除实例")])]),s("tr",[s("td",[s("code",[t._v("attributeChangedCallback(attrName, oldVal, newVal)")])]),s("td",[t._v("添加，移除，或修改一个属性")])])])]),s("p",[t._v("**示例：**为 "),s("code",[t._v("<x-foo>")]),t._v(" 定义 "),s("code",[t._v("createdCallback()")]),t._v(" 和 "),s("code",[t._v("attachedCallback()")]),t._v("：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" proto "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("create")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTMLElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nproto"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("createdCallback")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token operator"}},[t._v("...")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nproto"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("attachedCallback")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token operator"}},[t._v("...")]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" proto"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[s("strong",[t._v("所有生命周期回调都是可选的")]),t._v("，你可以只在需要关注的时间点定义它们。例如：假设你有一个很复杂的元素，它会在 "),s("code",[t._v("createdCallback()")]),t._v(" 打开一个 IndexedDB 连接。在将其从 DOM 移除时，"),s("code",[t._v("detachedCallback()")]),t._v(" 会做一些必要的清理工作。**注意：**不要过于依赖这些生命周期方法（比如用户直接关闭浏览器标签），仅将其作为可能的优化点。")]),s("p",[t._v("另一个生命周期回调的例子是为元素设置默认的事件监听器：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("proto"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("createdCallback")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'click'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token function"}},[t._v("alert")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'Thanks!'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("blockquote",[s("p",[t._v("如果你的元素太笨重，是不会有人用它的。生命周期回调可以帮你大忙！")])]),s("h2",{attrs:{id:"添加标记"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加标记","aria-hidden":"true"}},[t._v("#")]),t._v(" 添加标记")]),s("p",[t._v("我们已经创建好 "),s("code",[t._v("<x-foo>")]),t._v(" 并添加了 JavaScript API，但它还没有任何内容。不如我们给点 HTML 让它渲染？")]),s("p",[t._v("生命周期回调在这个时候就派上用场了。我们甚至可以用 "),s("code",[t._v("createdCallback()")]),t._v(" 给一个元素赋予一些默认的 HTML：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFooProto "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("create")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTMLElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nXFooProto"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("createdCallback")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"<b>I’m an x-foo-with-markup!</b>"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo-with-markup'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" XFooProto"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[t._v("实例化这个标签并在 DevTools 中观察（右击，选择“审查元素”），可以看到如下结构：")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("▾"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("x-foo-with-markup")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("b")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("I’m an x-foo-with-markup!"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("b")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("x-foo-with-markup")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("h3",{attrs:{id:"用-shadow-dom-封装内部实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用-shadow-dom-封装内部实现","aria-hidden":"true"}},[t._v("#")]),t._v(" 用 Shadow DOM 封装内部实现")]),s("p",[s("a",{attrs:{href:"http://www.html5rocks.com/tutorials/webcomponents/shadowdom/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Shadow DOM")]),t._v(" 本身是一个封装内容的强大工具，配合使用自定义元素就更神奇了！")]),s("p",[t._v("Shadow DOM 为自定义元素提供了：")]),s("ol",[s("li",[t._v("一种隐藏内部实现的方法，从而将用户与血淋淋的实现细节隔离开。")]),s("li",[t._v("简单有效的"),s("a",{attrs:{href:"http://www.html5rocks.com/tutorials/webcomponents/shadowdom-201/",target:"_blank",rel:"noopener noreferrer"}},[t._v("样式隔离")]),t._v("。")])]),s("p",[t._v("从 Shadow DOM 创建元素，跟创建一个渲染基础标记的元素非常类似，区别在于 "),s("code",[t._v("createdCallback()")]),t._v(" 回调：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFooProto "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("create")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTMLElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nXFooProto"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("createdCallback")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// 1. 为元素附加一个 shadow root。")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" shadow "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createShadowRoot")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// 2. 填入标记。")]),t._v("\n  shadow"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"<b>I’m in the element’s Shadow DOM!</b>"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" XFoo "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo-shadowdom'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" XFooProto"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("p",[t._v("我们并没有直接设置 "),s("code",[t._v("<x-foo-shadowdom>")]),t._v(" 的 "),s("code",[t._v("innerHTML")]),t._v("，而是为其创建了一个用于填充标记的 Shadow Root。在 DevTools 设置中勾选“Show Shadow DOM”，你就会看到一个可以展开的 "),s("code",[t._v("#shadow-root")]),t._v("：")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("▾"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("x-foo-shadowdom")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n   ▾#shadow-root\n     "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("b")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("I’m in the element’s Shadow DOM!"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("b")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("x-foo-shadowdom")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("这就是 Shadow Root！")]),s("h3",{attrs:{id:"从模板创建元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从模板创建元素","aria-hidden":"true"}},[t._v("#")]),t._v(" 从模板创建元素")]),s("p",[s("a",{attrs:{href:"http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-template-element",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML 模板")]),t._v("是另一组跟自定义元素完美融合的新 API。")]),s("p",[s("a",{attrs:{href:"http://www.html5rocks.com/tutorials/webcomponents/template/",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("<template>")]),t._v(" 元素")]),t._v("可用于声明 DOM 片段。它们可以被解析并在页面加载后插入，以及延迟到运行时才进行实例化。模板是声明自定义元素结构的理想方案。")]),s("p",[t._v("**示例：**注册一个由 "),s("code",[t._v("<template>")]),t._v(" 和 Shadow DOM 创建的元素：")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("sdtemplate"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{attrs:{class:"token style language-css"}},[t._v("\n    "),s("span",{attrs:{class:"token selector"}},[t._v("p")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{attrs:{class:"token property"}},[t._v("color")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" orange"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  ")]),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("I’m in Shadow DOM. My markup was stamped from a "),s("span",{attrs:{class:"token entity",title:"&"}},[t._v("&amp;")]),t._v("lt;template"),s("span",{attrs:{class:"token entity",title:"&"}},[t._v("&amp;")]),t._v("gt;."),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{attrs:{class:"token script language-javascript"}},[t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" proto "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("create")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HTMLElement"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  createdCallback"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    value"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" t "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("querySelector")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'#sdtemplate'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" clone "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("importNode")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("t"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("true")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{attrs:{class:"token keyword"}},[t._v("this")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createShadowRoot")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("clone"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("registerElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'x-foo-from-template'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("prototype"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" proto"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("短短几行做了很多事情，我们挨个来看都发生了些什么：")]),s("ol",[s("li",[t._v("我们在 HTML 中注册了一个新元素："),s("code",[t._v("<x-foo-from-template>")])]),s("li",[t._v("这个元素的 DOM 是从一个 "),s("code",[t._v("<template>")]),t._v(" 创建的")]),s("li",[t._v("Shadow DOM 隐藏了该元素可怕的细节")]),s("li",[t._v("Shadow DOM 也对元素的样式进行了隔离（比如 "),s("code",[t._v("p {color: orange;}")]),t._v(" 不会把整个页面都搞成"),s("span",{staticStyle:{color:"orange"}},[t._v("橙色")]),t._v("）")])]),s("p",[t._v("真不错！")]),s("h2",{attrs:{id:"为自定义元素增加样式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为自定义元素增加样式","aria-hidden":"true"}},[t._v("#")]),t._v(" 为自定义元素增加样式")]),s("p",[t._v("和其他 HTML 标签一样，自定义元素也可以用选择器定义样式：")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{attrs:{class:"token style language-css"}},[t._v("\n  "),s("span",{attrs:{class:"token selector"}},[t._v("app-panel")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("display")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" flex"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{attrs:{class:"token selector"}},[t._v('[is="x-item"]')]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("transition")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" opacity 400ms ease-in-out"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("opacity")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0.3"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("flex")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 1"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("text-align")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" center"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("border-radius")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 50%"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{attrs:{class:"token selector"}},[t._v('[is="x-item"]:hover')]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("opacity")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 1.0"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("background")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("rgb")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("255, 0, 255"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("color")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" white"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{attrs:{class:"token selector"}},[t._v('app-panel > [is="x-item"]')]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("padding")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 5px"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("list-style")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("margin")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0 7px"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")]),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("app-panel")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("is")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("x-item"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Do\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("is")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("x-item"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Re\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("is")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("x-item"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Mi\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("app-panel")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("h3",{attrs:{id:"为使用-shadow-dom-的元素增加样式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为使用-shadow-dom-的元素增加样式","aria-hidden":"true"}},[t._v("#")]),t._v(" 为使用 Shadow DOM 的元素增加样式")]),s("p",[t._v("有了 Shadow DOM 场面就热闹得多了，它可以极大增强自定义元素的能力。")]),s("p",[t._v("Shadow DOM 为元素增加了样式封装的特性。Shadow Root 中定义的样式不会暴露到宿主外部或对页面产生影响。**对自定义元素来说，元素本身就是宿主。**样式封装的属性也使得自定义元素能够为自己定义默认样式。")]),s("p",[t._v("Shadow DOM 的样式是一个很大的话题！如果你想更多地了解它，推荐你阅读我写的其他文章：")]),s("ul",[s("li",[s("a",{attrs:{href:"http://www.polymer-project.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("Polymer")]),t._v(" 文档："),s("a",{attrs:{href:"http://www.polymer-project.org/articles/styling-elements.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("元素样式指南")]),t._v("。")]),s("li",[t._v("发表于 "),s("a",{attrs:{href:"http://www.html5rocks.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML5Rocks")]),t._v(" 的 "),s("a",{attrs:{href:"http://www.html5rocks.com/tutorials/webcomponents/shadowdom-201/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Shadow DOM 201：CSS 和样式")]),t._v("。")])]),s("h3",{attrs:{id:"使用-unresolved-伪类避免无样式内容闪烁（fouc）"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-unresolved-伪类避免无样式内容闪烁（fouc）","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用 "),s("code",[t._v(":unresolved")]),t._v(" 伪类避免无样式内容闪烁（FOUC）")]),s("p",[t._v("为了缓解"),s("a",{attrs:{href:"http://en.wikipedia.org/wiki/Flash_of_unstyled_content",target:"_blank",rel:"noopener noreferrer"}},[t._v("无样式内容闪烁")]),t._v("的影响，自定义元素规范提出了一个新的 CSS 伪类 "),s("code",[t._v(":unresolved")]),t._v("。在浏览器调用你的 "),s("code",[t._v("createdCallback()")]),t._v("（见"),s("strong",[t._v("生命周期回调方法")]),t._v("一节）之前，这个伪类都可以匹配到 unresolved 元素。一旦产生调用，就意味着元素已经完成提升，成为它被定义的形态，该元素就不再是一个 unresolved 元素了。")]),s("p",[t._v("**提示：**Chrome 29 已经原生支持 CSS "),s("code",[t._v(":unresolved")]),t._v(" 伪类。")]),s("p",[t._v("**示例：**注册后渐显的 "),s("code",[t._v("<x-foo>")]),t._v(" 标签：")]),s("pre",{pre:!0,attrs:{class:"language-css"}},[s("code",[s("span",{attrs:{class:"token selector"}},[t._v("x-foo")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token property"}},[t._v("opacity")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 1"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token property"}},[t._v("transition")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" opacity 300ms"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token selector"}},[t._v("x-foo:unresolved")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token property"}},[t._v("opacity")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("p",[t._v("请记住 "),s("code",[t._v(":unresolved")]),t._v(" 伪类只能用于 unresolved 元素，而不能用于继承自 "),s("code",[t._v("HTMLUnkownElement")]),t._v(" 的元素（见"),s("strong",[t._v("元素如何提升")]),t._v("一节）。")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{attrs:{class:"token style language-css"}},[t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("/* 给所有 unresolved 元素添加边框 */")]),t._v("\n  "),s("span",{attrs:{class:"token selector"}},[t._v(":unresolved")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("border")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 1px dashed red"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("display")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" inline-block"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("/* unresolved 元素 x-panel 的文本内容为红色 */")]),t._v("\n  "),s("span",{attrs:{class:"token selector"}},[t._v("x-panel:unresolved")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("color")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" red"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("/* 定义注册后的 x-panel 文本内容为绿色 */")]),t._v("\n  "),s("span",{attrs:{class:"token selector"}},[t._v("x-panel")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("color")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" green"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("display")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" block"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("padding")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 5px"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token property"}},[t._v("display")]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" block"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")]),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("panel")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  I’m black because :unresolved doesn’t apply to “panel”.\n  It’s not a valid custom element name.\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("panel")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("x-panel")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("I’m red because I match x-panel:unresolved."),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("x-panel")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("了解更多 "),s("code",[t._v(":unresolved")]),t._v(" 伪类的知识，请看 Polymer 文档"),s("a",{attrs:{href:"http://www.polymer-project.org/articles/styling-elements.html#preventing-fouc",target:"_blank",rel:"noopener noreferrer"}},[t._v("元素样式指南")]),t._v("。")]),s("h2",{attrs:{id:"历史和浏览器支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#历史和浏览器支持","aria-hidden":"true"}},[t._v("#")]),t._v(" 历史和浏览器支持")]),s("h3",{attrs:{id:"特性检测"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特性检测","aria-hidden":"true"}},[t._v("#")]),t._v(" 特性检测")]),s("p",[t._v("特性检测就是检查 "),s("code",[t._v("document.registerElement()")]),t._v(" 是否存在：")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("supportsCustomElements")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'registerElement'")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token function"}},[t._v("supportsCustomElements")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// 使用自定义元素 API")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token comment"}},[t._v("// 使用其他类库创建组件")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("h3",{attrs:{id:"浏览器支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器支持","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器支持")]),s("p",[t._v("Chrome 27 和 Firefox 23 都提供了对 "),s("code",[t._v("document.registerElement()")]),t._v(" 的支持，不过之后规范又有一些演化。Chrome 31 将是第一个真正支持新规范的版本。")]),s("p",[t._v("**提示：**在 Chrome 31 中使用自定义元素，需要开启 "),s("em",[t._v("about:flags")]),t._v(" 中的“实验性 web 平台特性（Experimental Web Platform features）”选项。")]),s("p",[t._v("在浏览器支持稳定之前，也有一些很好的兼容方案：")]),s("ul",[s("li",[t._v("Google 的 "),s("a",{attrs:{href:"http://polymer-project.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("Polymer")]),t._v(" 集成了一个"),s("a",{attrs:{href:"http://www.polymer-project.org/platform/custom-elements.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("兼容方案")])]),s("li",[t._v("Mozilla 的 "),s("a",{attrs:{href:"http://www.x-tags.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("x-tags")])])]),s("h3",{attrs:{id:"htmlelementelement-怎么了？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#htmlelementelement-怎么了？","aria-hidden":"true"}},[t._v("#")]),s("code",[t._v("HTMLElementElement")]),t._v(" 怎么了？")]),s("p",[t._v("一直关注标准的人都知道曾经有一个 "),s("code",[t._v("<element>")]),t._v(" 标签。它非常好用，你只要像下面这样就可以声明式地注册一个新元素：")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("element")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("my-element"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  ...\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("element")]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("然而很不幸，在它的提升过程、极端用例，以及末日般的复杂场景中，需要处理大量的时序问题。"),s("code",[t._v("<element>")]),t._v(" 因此被迫搁置。2013 年 8 月，Dimitri Glazkov 在 "),s("a",{attrs:{href:"http://lists.w3.org/Archives/Public/public-webapps/2013JulSep/0287.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("public-webapps")]),t._v(" 邮件组中宣告移除 "),s("code",[t._v("<element>")]),t._v("。")]),s("p",[t._v("值得注意的是，Polymer 实现了以 "),s("code",[t._v("<polymer-element>")]),t._v(" 的形式声明式地注册元素。这是怎么做到的？它用的正是 "),s("code",[t._v("document.registerElement('polymer-element')")]),t._v(" 以及我在"),s("strong",[t._v("从模板创建元素")]),t._v("一节介绍的技术。")]),s("h2",{attrs:{id:"结语"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#结语","aria-hidden":"true"}},[t._v("#")]),t._v(" 结语")]),s("p",[t._v("自定义元素为我们提供了一个工具，通过它我们可以扩展 HTML 的词汇，赋予它新的特性，并把不同的 web 平台连接在一起。结合其他新的基本平台，如 Shadow DOM 和 "),s("code",[t._v("<template>")]),t._v("，我们领略了 web 组件的宏伟蓝图。标记语言将再次变得很时髦！")]),s("p",[t._v("如果你对使用 web 组件感兴趣，建议你看看 "),s("a",{attrs:{href:"http://polymer-project.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("Polymer")]),t._v("，它已经有了你想要的一切。")])])}],!1,null,null,null);a.default=o.exports}}]);